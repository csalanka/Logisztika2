<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Siemens Energy Ikon</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <style>
        :root {
            --table-container-padding-top: 0px;
            --th-top: 0px;
        }
        body {
            background-color: #000000;
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #e0e0e0;
            font-family: Arial, sans-serif;
            overflow: hidden;
        }
        .container {
            width: 100%;
            height: 100vh;
            border: 2px solid #621d8a;
            border-radius: 10px;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            padding: 10px;
            box-sizing: border-box;
            padding-top: 180px;
            overflow: hidden;
        }
        .header {
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px;
            box-sizing: border-box;
            position: fixed;
            top: 0;
            background-color: #000000;
            z-index: 10;
        }
        .header-left {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            gap: 5px;
        }
        .header-left-logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .header img {
            width: 128px;
            height: 70px;
        }
        .logo-note {
            font-size: 10px;
            color: #e0e0e0;
            text-align: center;
            width: 100%;
        }
        .copyright-note {
            font-size: 10px;
            color: #e0e0e0;
        }
        .header-right {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-right: 20px;
        }
        .header-right span, .header-right i {
            font-size: 14px;
            color: #e0e0e0;
            cursor: pointer;
        }
        .header-right i:hover, .fullscreen-icon:hover {
            color: #621d8a;
        }
        .fullscreen-icon {
            font-size: 16px;
            color: #e0e0e0;
            cursor: pointer;
        }
        .divider {
            width: 100%;
            height: 2px;
            background-color: #621d8a;
            margin: 0;
            position: fixed;
            top: 110px;
            z-index: 9;
        }
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            margin-left: 10px;
            position: fixed;
            top: 120px;
            z-index: 9;
            overflow-x: auto;
            width: calc(100% - 40px);
        }
        .tabs::-webkit-scrollbar {
            height: 8px;
        }
        .tabs::-webkit-scrollbar-thumb {
            background-color: #621d8a;
            border-radius: 5px;
        }
        .tabs::-webkit-scrollbar-track {
            background-color: #2a2a2a;
        }
        .tab {
            padding: 10px 20px;
            background-color: #1a1a1a;
            border: 1px solid #621d8a;
            border-radius: 5px;
            cursor: pointer;
            white-space: nowrap;
            transition: background-color 0.3s;
        }
        .tab.active {
            background-color: #621d8a;
            color: #e0e0e0;
        }
        .tab:hover {
            background-color: #2a2a2a;
        }
        .tab-content {
            width: 100%;
            flex-grow: 1;
            padding: 20px;
            background-color: #1a1a1a;
            border-radius: 5px;
            height: calc(100vh - 160px);
            box-sizing: border-box;
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .table-container {
            width: 100%;
            max-height: calc(100vh - 200px);
            min-height: calc(100vh - 200px);
            overflow-x: auto;
            overflow-y: auto;
            scroll-behavior: smooth;
            will-change: transform;
            padding-top: var(--table-container-padding-top);
            padding-right: 17px;
        }
        .table-container::-webkit-scrollbar {
            width: 10px;
        }
        .table-container::-webkit-scrollbar-thumb {
            background-color: #621d8a;
            border-radius: 5px;
            min-height: 20px;
        }
        .table-container::-webkit-scrollbar-track {
            background-color: #2a2a2a;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            margin-top: -2px;
        }
        th, td {
            padding: 10px;
            border: 1px solid #621d8a;
            text-align: left;
            white-space: nowrap;
        }
        th {
            background-color: #2a2a2a;
            position: sticky;
            top: var(--th-top);
            z-index: 3;
            height: 40px;
            line-height: 40px;
        }
        tr:nth-child(even) {
            background-color: #222222;
        }
        #logisztikai-table th:nth-child(1), #logisztikai-table td:nth-child(1) { width: 30px; } /* Checkbox oszlop */
        #logisztikai-table th:nth-child(2), #logisztikai-table td:nth-child(2) { width: 100px; }
        #logisztikai-table th:nth-child(3), #logisztikai-table td:nth-child(3) { width: 50px; }
        #logisztikai-table th:nth-child(4), #logisztikai-table td:nth-child(4) { width: 100px; }
        #logisztikai-table th:nth-child(5), #logisztikai-table td:nth-child(5) { width: 100px; }
        #logisztikai-table th:nth-child(6), #logisztikai-table td:nth-child(6) { width: 100px; }
        #logisztikai-table th:nth-child(7), #logisztikai-table td:nth-child(7) { width: 150px; }
        #logisztikai-table th:nth-child(8), #logisztikai-table td:nth-child(8) { width: 80px; }
        #logisztikai-table th:nth-child(9), #logisztikai-table td:nth-child(9) { width: 150px; }
        #logisztikai-table th:nth-child(10), #logisztikai-table td:nth-child(10) { width: 100px; }
        #logisztikai-table th:nth-child(11), #logisztikai-table td:nth-child(11) { width: 120px; }
        #logisztikai-table th:nth-child(12), #logisztikai-table td:nth-child(12) { width: 80px; }
        #logisztikai-table th:nth-child(13), #logisztikai-table td:nth-child(13) { width: 100px; }
        #logisztikai-table th:nth-child(14), #logisztikai-table td:nth-child(14) { width: 80px; }
        #logisztikai-table th:nth-child(15), #logisztikai-table td:nth-child(15) { width: 60px; }
        #logisztikai-table th:nth-child(16), #logisztikai-table td:nth-child(16) { width: 60px; }
        #logisztikai-table th:nth-child(17), #logisztikai-table td:nth-child(17) { width: 80px; }
        #logisztikai-table th:nth-child(18), #logisztikai-table td:nth-child(18) { width: 100px; }
        #logisztikai-table th:nth-child(19), #logisztikai-table td:nth-child(19) { width: 100px; }
        #belső-megrendelési-table th:nth-child(1), #belső-megrendelési-table td:nth-child(1) { width: 150px; }
        #belső-megrendelési-table th:nth-child(2), #belső-megrendelési-table td:nth-child(2) { width: 150px; }
        #belső-megrendelési-table th:nth-child(3), #belső-megrendelési-table td:nth-child(3) { width: 150px; }
        #belső-megrendelési-table th:nth-child(4), #belső-megrendelési-table td:nth-child(4) { width: 150px; }
        #szallitoi-cimjegyzek-table th:nth-child(1), #szallitoi-cimjegyzek-table td:nth-child(1) { width: 200px; }
        #szallitoi-cimjegyzek-table th:nth-child(2), #szallitoi-cimjegyzek-table td:nth-child(2) { width: 200px; }
        #keretrendelesek-table th:nth-child(1), #keretrendelesek-table td:nth-child(1) { width: 150px; }
        #keretrendelesek-table th:nth-child(2), #keretrendelesek-table td:nth-child(2) { width: 150px; }
        #keretrendelesek-table th:nth-child(3), #keretrendelesek-table td:nth-child(3) { width: 100px; }
        #keretrendelesek-table th:nth-child(4), #keretrendelesek-table td:nth-child(4) { width: 100px; }
        #keretrendelesek-table th:nth-child(5), #keretrendelesek-table td:nth-child(5) { width: 100px; }
        #keretrendelesek-table th:nth-child(6), #keretrendelesek-table td:nth-child(6) { width: 100px; }
        #keretrendelesek-table th:nth-child(7), #keretrendelesek-table td:nth-child(7) { width: 150px; }
        #logisztikai-table th, #belső-megrendelési-table th, #szallitoi-cimjegyzek-table th, #keretrendelesek-table th {
            position: sticky;
            top: var(--th-top);
            background-color: #2a2a2a;
            z-index: 3;
            height: 40px;
            line-height: 40px;
        }
        .edit-btn, .new-record-btn {
            padding: 5px 10px;
            background-color: #621d8a;
            border: none;
            border-radius: 5px;
            color: #e0e0e0;
            cursor: pointer;
            margin: 2px;
            position: relative;
            z-index: 10001;
        }
        .modal {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
        }
        .modal-content {
            background-color: #1a1a1a;
            padding: 20px;
            border-radius: 10px;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            text-align: center;
            border: 1px solid #621d8a;
            box-sizing: border-box;
        }
        .new-record-form, .edit-form {
            display: flex;
            flex-direction: column;
            gap: 10px;
            width: 100%;
        }
        .edit-form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            width: 100%;
        }
        .edit-form h3 {
            grid-column: 1 / 3;
            margin-top: 10px;
            border-bottom: 1px solid #621d8a;
            padding-bottom: 5px;
        }
        .edit-form label, .edit-form input, .edit-form select {
            display: block;
            width: 100%;
        }
        .edit-form button {
            grid-column: 1 / 3;
        }
        .new-record-form label, .edit-form label {
            font-weight: bold;
            text-align: left;
        }
        .new-record-form input, .new-record-form select, .edit-form input, .edit-form select {
            padding: 5px;
            border: none;
            border-radius: 5px;
            background-color: #3c3c3c;
            color: #e0e0e0;
        }
        .new-record-form button, .edit-form button {
            padding: 10px;
            background-color: #621d8a;
            border: none;
            border-radius: 5px;
            color: #e0e0e0;
            cursor: pointer;
        }
        .send-email-btn {
            background-color: #4CAF50;
        }
        #email-result {
            margin-top: 10px;
            color: #4CAF50;
        }
        .status-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        .status-btn {
            padding: 5px 10px;
            border: none;
            border-radius: 5px;
            font-size: 11px;
            cursor: default;
            opacity: 0.8;
            white-space: nowrap;
        }
        .status-btn:hover {
            opacity: 1;
        }
        .button-container {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 10px;
        }
        .select-row, #select-all {
            cursor: pointer;
        }
        .fa-envelope.sent {
            color: #4CAF50;
        }
        .fa-envelope.not-sent {
            color: #808080;
        }
        .error-message {
            color: #ff4444;
            font-size: 14px;
            margin-top: 10px;
        }
    </style>
</head>
<body onload="toggleFullscreen(); initializeSorszamCounter(); loadBelsőMegrendelésiSzámok(); loadSzallitoiCimjegyzek(); loadKeretrendelesek();">
    <div class="container" id="container">
        <div class="header">
            <div class="header-left">
                <div class="header-left-logo">
                    <img src="siemens-energy-logo.png" alt="Siemens Energy Logo">
                    <span class="copyright-note">© 2025 [A Neved]. Minden jog fenntartva. Engedély nélküli felhasználás tilos.</span>
                </div>
                <span class="logo-note">Ideiglenes logó, hamarosan változik</span>
            </div>
            <div class="header-right">
                <i class="fas fa-envelope" title="Üzenetek"></i>
                <i class="fas fa-question-circle" title="Segítség"></i>
                <span>v1.3.0</span>
                <i class="fas fa-expand fullscreen-icon" onclick="toggleFullscreen()" title="Teljes képernyő"></i>
            </div>
        </div>
        <div class="divider"></div>
        <div class="tabs">
            <div class="tab active" onclick="openTab('logisztikai-adatbazis')">Logisztikai adatbázis</div>
            <div class="tab" onclick="openTab('belső-megrendelési-szamok')">Belső megrendelési számok</div>
            <div class="tab" onclick="openTab('keretrendelesek')">Keretrendelések</div>
            <div class="tab" onclick="openTab('szallitoi-cimjegyzek')">Szállítói címjegyzék</div>
            <div class="tab" onclick="openTab('anyagtörzs')">Anyagtörzs</div>
            <div class="tab" onclick="openTab('nyomonkövetési-listák')">Nyomonkövetési listák</div>
            <div class="tab" onclick="openTab('foglalások')">Foglalások</div>
            <div class="tab" onclick="openTab('statisztika')">Statisztika</div>
            <div class="tab" onclick="openTab('chat-lista')">Chat Lista</div>
            <div class="tab" onclick="openTab('felhasználó-kezelés')">Felhasználó kezelés</div>
            <div class="tab" onclick="openTab('hibajelentés-fejlesztési-javaslat')">Hibajelentés Fejlesztési javaslat</div>
        </div>

        <!-- Logisztikai adatbázis tab -->
        <div class="tab-content active" id="logisztikai-adatbazis">
            <h2>Logisztikai adatbázis</h2>
            <div class="button-container">
                <button class="new-record-btn" onclick="openNewRecordModal()">Új rekord</button>
                <div class="status-buttons">
                    <button class="status-btn" data-status="felvett" style="background-color: #FFFFFF; color: #000000;">Felvett</button>
                    <button class="status-btn" data-status="ajanlatkikuldve" style="background-color: #FFFF00; color: #000000;">Ajánlatkérés kiküldve</button>
                    <button class="status-btn" data-status="belsoszam" style="background-color: #808080; color: #FFFFFF;">Belső igényszám kitöltve</button>
                    <button class="status-btn" data-status="po" style="background-color: #0000FF; color: #FFFFFF;">PO szám létrehozva</button>
                    <button class="status-btn" data-status="beerkezett" style="background-color: #008000; color: #FFFFFF;">Tétel beérkezett</button>
                    <button class="status-btn" data-status="megszakitva" style="background-color: #000000; color: #FFFFFF;">Megszakítva</button>
                </div>
            </div>
            <div class="table-container">
                <table id="logisztikai-table">
                    <thead>
                        <tr>
                            <th><input type="checkbox" id="select-all"></th>
                            <th>Műveleti</th>
                            <th>Sr.</th>
                            <th>Felvéve</th>
                            <th>Raktár</th>
                            <th>Kontírozás</th>
                            <th>Kontírozási név</th>
                            <th>Ak.</th>
                            <th>Megnevezés</th>
                            <th>Folyamat</th>
                            <th>Szállító</th>
                            <th>Sz.kód</th>
                            <th>Ajánlatszám</th>
                            <th>Mennyiség</th>
                            <th>Egység</th>

                            <th>Ár</th>
                            <th>EUR/HUF</th>
                            <th>BMIg.</th>
                            <th>PO</th>
                            <th>T.Szállítás</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr data-ajanlatkikuldve="false">
                            <td><input type="checkbox" class="select-row"></td>
                            <td>
                                <button class="edit-btn" onclick="openEditModal(this)">Szerkesztés</button>
                            </td>
                            <td>FR25#0001</td>
                            <td>2025.03.01</td>
                            <td>0060</td>
                            <td>2025.03.02</td>
                            <td>-</td>
                            <td><i class="fas fa-envelope not-sent" title="Levél küldése" onclick="sendEmailFromTable(this)"></i></td>
                            <td>Csavar M8</td>
                            <td>Beszerzés</td>
                            <td>Szállító 1</td>
                            <td>001</td>
                            <td>AJ123</td>
                            <td>100</td>
                            <td>DB.</td>
                            <td>50</td>
                            <td>EUR</td>
                            <td>2025.03.10</td>
                            <td>PO123</td>
                            <td>2025.03.15</td>
                        </tr>
                        <tr data-ajanlatkikuldve="false">
                            <td><input type="checkbox" class="select-row"></td>
                            <td>
                                <button class="edit-btn" onclick="openEditModal(this)">Szerkesztés</button>
                            </td>
                            <td>FR25#0002</td>
                            <td>2025.03.02</td>
                            <td>0350</td>
                            <td>2025.03.03</td>
                            <td>-</td>
                            <td><i class="fas fa-envelope not-sent" title="Levél küldése" onclick="sendEmailFromTable(this)"></i></td>
                            <td>Alátét M8</td>
                            <td>Gyártás</td>
                            <td>Szállító 2</td>
                            <td>002</td>
                            <td>AJ124</td>
                            <td>200</td>
                            <td>DB.</td>
                            <td>30</td>
                            <td>HUF</td>
                            <td>2025.03.12</td>
                            <td>PO124</td>
                            <td>2025.03.18</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Belső megrendelési számok tab -->
        <div class="tab-content" id="belső-megrendelési-szamok">
            <h2>Belső megrendelési számok</h2>
            <div id="belső-megrendelési-error" class="error-message"></div>
            <div class="table-container">
                <table id="belső-megrendelési-table">
                    <thead>
                        <tr>
                            <th>Terület</th>
                            <th>Gép neve</th>
                            <th>Belső rendelési szám</th>
                            <th>SAP költséghely szám</th>
                        </tr>
                    </thead>
                    <tbody id="belső-megrendelési-tbody">
                        <!-- A belső megrendelési számok dinamikusan töltődnek be -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Keretrendelések tab -->
        <div class="tab-content" id="keretrendelesek">
            <h2>Keretrendelések</h2>
            <div id="keretrendelesek-error" class="error-message"></div>
            <div class="table-container">
                <table id="keretrendelesek-table">
                    <thead>
                        <tr>
                            <th>Terület</th>
                            <th>Szállító</th>
                            <th>BMIg.</th>
                            <th>PO</th>
                            <th>Érvényesség kezdete</th>
                            <th>Érvényesség vége</th>
                            <th>Megjegyzés</th>
                        </tr>
                    </thead>
                    <tbody id="keretrendelesek-tbody">
                        <!-- A keretrendelések dinamikusan töltődnek be -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Szállítói címjegyzék tab -->
        <div class="tab-content" id="szallitoi-cimjegyzek">
            <h2>Szállítói címjegyzék</h2>
            <div id="szallitoi-cimjegyzek-error" class="error-message"></div>
            <div class="table-container">
                <table id="szallitoi-cimjegyzek-table">
                    <thead>
                        <tr>
                            <th>Szállító neve</th>
                            <th>Email</th>
                        </tr>
                    </thead>
                    <tbody id="szallitoi-cimjegyzek-tbody">
                        <!-- A szállítói címjegyzék dinamikusan töltődik be -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Egyéb tabok (üresen, később töltjük fel) -->
        <div class="tab-content" id="anyagtörzs">
            <h2>Anyagtörzs</h2>
            <p>Itt lesz az anyagtörzs tartalma.</p>
        </div>
        <div class="tab-content" id="nyomonkövetési-listák">
            <h2>Nyomonkövetési listák</h2>
            <p>Itt lesznek a nyomonkövetési listák.</p>
        </div>
        <div class="tab-content" id="foglalások">
            <h2>Foglalások</h2>
            <p>Itt lesznek a foglalások.</p>
        </div>
        <div class="tab-content" id="statisztika">
            <h2>Statisztika</h2>
            <p>Itt lesz a statisztika tartalma.</p>
        </div>
        <div class="tab-content" id="chat-lista">
            <h2>Chat Lista</h2>
            <p>Itt lesz a chat lista tartalma.</p>
        </div>
        <div class="tab-content" id="felhasználó-kezelés">
            <h2>Felhasználó kezelés</h2>
            <p>Itt lesz a felhasználó kezelés tartalma.</p>
        </div>
        <div class="tab-content" id="hibajelentés-fejlesztési-javaslat">
            <h2>Hibajelentés Fejlesztési javaslat</h2>
            <p>Itt lesz a hibajelentés és fejlesztési javaslat tartalma.</p>
        </div>

        <!-- Új rekord modal -->
        <div class="modal" id="newRecordModal">
            <div class="modal-content">
                <h2>Új rekord felvétele</h2>
                <form class="new-record-form" id="newRecordForm">
                    <label for="new-felveve">Felvéve:</label>
                    <input type="date" id="new-felveve" required>

                    <label for="new-raktar">Raktár:</label>
                    <select id="new-raktar" required>
                        <option value="0060">0060</option>
                        <option value="0350">0350</option>
                    </select>

                    <label for="rendeles-tipus">Rendelés típusa:</label>
                    <select id="rendeles-tipus" onchange="updateKontirozasField(); updateFolyamatField(); updatePriceFields(); updateSzallitoField();">
                        <option value="1">Keretrendelés</option>
                        <option value="2">Raktárkészlet</option>
                        <option value="3">Gépre kontírozott rendelés</option>
                        <option value="4">Területre kontírozott rendelés</option>
                        <option value="5">Karbantartási rendelés</option>
                    </select>

                    <div id="kontirozas-container">
                        <label for="new-kontirozas">Kontírozás:</label>
                        <input type="date" id="new-kontirozas">
                    </div>

                    <div id="kontirozasi-nev-container" style="display: none;">
                        <label for="new-terulet">Válassz területet:</label>
                        <select id="new-terulet" onchange="updateKeretrendelesFields()">
                            <!-- Dinamikusan töltődik -->
                        </select>
                    </div>

                    <label for="new-megnevezes">Megnevezés:</label>
                    <input type="text" id="new-megnevezes" required>

                    <label for="new-folyamat">Folyamat:</label>
                    <select id="new-folyamat" required>
                        <!-- Dinamikusan töltődik -->
                    </select>

                    <label for="new-szallito">Szállító:</label>
                    <input type="text" id="new-szallito" required>

                    <div id="szallito-select-container" style="display: none;">
                        <label for="new-szallito-select">Szállító kiválasztása:</label>
                        <select id="new-szallito-select" onchange="updateKeretrendelesFields()">
                            <!-- Dinamikusan töltődik -->
                        </select>
                    </div>

                    <label for="new-szam">Sz.kód:</label>
                    <input type="text" id="new-szam" required>

                    <label for="new-ajanlatszam">Ajánlatszám:</label>
                    <input type="text" id="new-ajanlatszam" required>

                    <label for="new-mennyiseg">Mennyiség:</label>
                    <input type="number" id="new-mennyiseg" required>

                    <label for="new-egység">Egység:</label>
                    <select id="new-egység" required>
                        <option value="DB.">DB.</option>
                        <option value="KG">KG</option>
                        <option value="M">M</option>
                    </select>

                    <div id="price-container">
                        <label for="new-ar">Ár:</label>
                        <input type="number" id="new-ar" step="any">

                        <label for="new-eur-huf">EUR/HUF:</label>
                        <select id="new-eur-huf">
                            <option value="EUR">EUR</option>
                            <option value="HUF">HUF</option>
                        </select>
                    </div>

                    <label for="new-bmig">BMIg.:</label>
                    <input type="text" id="new-bmig">

                    <label for="new-po">PO:</label>
                    <input type="text" id="new-po">

                    <label for="new-tervezett">Tervezett szállítás:</label>
                    <input type="date" id="new-tervezett">

                    <button type="button" onclick="saveNewRecord()">Mentés</button>
                    <button type="button" onclick="closeNewRecordModal()">Bezárás</button>
                </form>
            </div>
        </div>

        <!-- Szerkesztés modal -->
        <div class="modal" id="editModal">
            <div class="modal-content">
                <h2>Rekord szerkesztése</h2>
                <form class="edit-form" id="editForm">
                    <label for="edit-felveve">Felvéve:</label>
                    <input type="date" id="edit-felveve" required>

                    <label for="edit-raktar">Raktár:</label>
                    <select id="edit-raktar" required>
                        <option value="0060">0060</option>
                        <option value="0350">0350</option>
                    </select>

                    <label for="edit-rendeles-tipus">Rendelés típusa:</label>
                    <select id="edit-rendeles-tipus" onchange="updateEditKontirozasField(); updateEditFolyamatField(); updateEditPriceFields(); updateEditSzallitoField();">
                        <option value="1">Keretrendelés</option>
                        <option value="2">Raktárkészlet</option>
                        <option value="3">Gépre kontírozott rendelés</option>
                        <option value="4">Területre kontírozott rendelés</option>
                        <option value="5">Karbantartási rendelés</option>
                    </select>

                    <div id="edit-kontirozas-container">
                        <label for="edit-kontirozas">Kontírozás:</label>
                        <input type="date" id="edit-kontirozas">
                    </div>

                    <div id="edit-kontirozasi-nev-container" style="display: none;">
                        <label for="edit-terulet">Válassz területet:</label>
                        <select id="edit-terulet" onchange="updateEditKeretrendelesFields()">
                            <!-- Dinamikusan töltődik -->
                        </select>
                    </div>

                    <label for="edit-megnevezes">Megnevezés:</label>
                    <input type="text" id="edit-megnevezes" required>

                    <label for="edit-folyamat">Folyamat:</label>
                    <select id="edit-folyamat" required>
                        <!-- Dinamikusan töltődik -->
                    </select>

                    <label for="edit-szallito">Szállító:</label>
                    <input type="text" id="edit-szallito" required>

                    <div id="edit-szallito-select-container" style="display: none;">
                        <label for="edit-szallito-select">Szállító kiválasztása:</label>
                        <select id="edit-szallito-select" onchange="updateEditKeretrendelesFields()">
                            <!-- Dinamikusan töltődik -->
                        </select>
                    </div>

                    <label for="edit-szam">Sz.kód:</label>
                    <input type="text" id="edit-szam" required>

                    <label for="edit-ajanlatszam">Ajánlatszám:</label>
                    <input type="text" id="edit-ajanlatszam" required>

                    <label for="edit-mennyiseg">Mennyiség:</label>
                    <input type="number" id="edit-mennyiseg" required>

                    <label for="edit-egység">Egység:</label>
                    <select id="edit-egység" required>
                        <option value="DB.">DB.</option>
                        <option value="KG">KG</option>
                        <option value="M">M</option>
                    </select>

                    <div id="edit-price-container">
                        <label for="edit-ar">Ár:</label>
                        <input type="number" id="edit-ar" step="any">

                        <label for="edit-eur-huf">EUR/HUF:</label>
                        <select id="edit-eur-huf">
                            <option value="EUR">EUR</option>
                            <option value="HUF">HUF</option>
                        </select>
                    </div>

                    <label for="edit-bmig">BMIg.:</label>
                    <input type="text" id="edit-bmig">

                    <label for="edit-po">PO:</label>
                    <input type="text" id="edit-po">

                    <label for="edit-tervezett">Tervezett szállítás:</label>
                    <input type="date" id="edit-tervezett">

                    <button type="button" onclick="saveEdit()">Mentés</button>
                    <button type="button" class="send-email-btn" onclick="sendEmail()">Levél küldése</button>
                    <button type="button" onclick="closeEditModal()">Bezárás</button>
                    <div id="email-result"></div>
                </form>
            </div>
        </div>
    </div>

    <script>
        let sorszamCounter = 0;
        let belsőMegrendelésiSzámok = [];
        let szallitoiCimjegyzek = [];
        let keretrendelesek = [];

        // Ideiglenes statikus keretrendelesek adat, ha a CSV betöltés nem sikerül
        const fallbackKeretrendelesek = [
            { Terület: "MFC-terület", Szállító: "Szállító 1", BMIg: "BMIg123", PO: "PO123", "Érvényesség kezdete": "2025.01.01", "Érvényesség vége": "2025.12.31", Megjegyzés: "Teszt 1" },
            { Terület: "MFS-terület", Szállító: "Szállító 2", BMIg: "BMIg456", PO: "PO456", "Érvényesség kezdete": "2025.01.01", "Érvényesség vége": "2025.12.31", Megjegyzés: "Teszt 2" },
            { Terület: "MFH-terület", Szállító: "Szállító 3", BMIg: "BMIg789", PO: "PO789", "Érvényesség kezdete": "2025.01.01", "Érvényesség vége": "2025.12.31", Megjegyzés: "Teszt 3" },
            { Terület: "M2B-terület", Szállító: "Szállító 4", BMIg: "BMIg012", PO: "PO012", "Érvényesség kezdete": "2025.01.01", "Érvényesség vége": "2025.12.31", Megjegyzés: "Teszt 4" }
        ];

        function initializeSorszamCounter() {
            const rows = document.querySelectorAll('#logisztikai-table tbody tr');
            rows.forEach((row, index) => {
                const sorszamCell = row.cells[2];
                sorszamCell.textContent = `FR25#${String(index + 1).padStart(4, '0')}`;
            });
            sorszamCounter = rows.length;
        }

        function loadBelsőMegrendelésiSzámok() {
            fetch('belső_megrendelési_számok.csv')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Nem sikerült betölteni a belső_megrendelési_számok.csv fájlt.');
                    }
                    return response.text();
                })
                .then(data => {
                    Papa.parse(data, {
                        header: true,
                        skipEmptyLines: true,
                        complete: function(results) {
                            belsőMegrendelésiSzámok = results.data;
                            const tbody = document.getElementById('belső-megrendelési-tbody');
                            belsőMegrendelésiSzámok.forEach(row => {
                                const tr = document.createElement('tr');
                                tr.innerHTML = `
                                    <td>${row.Terület || '-'}</td>
                                    <td>${row['Gép neve'] || '-'}</td>
                                    <td>${row['Belső rendelési szám'] || '-'}</td>
                                    <td>${row['SAP költséghely szám'] || '-'}</td>
                                `;
                                tbody.appendChild(tr);
                            });
                        }
                    });
                })
                .catch(error => {
                    console.error('Hiba a belső megrendelési számok betöltésekor:', error);
                    document.getElementById('belső-megrendelési-error').textContent = 'Hiba: Nem sikerült betölteni a belső megrendelési számokat. Kérlek, ellenőrizd a CSV fájlt és a szerver beállításokat.';
                });
        }

        function loadSzallitoiCimjegyzek() {
            fetch('szallitoi_cimjegyzek.csv')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Nem sikerült betölteni a szallitoi_cimjegyzek.csv fájlt.');
                    }
                    return response.text();
                })
                .then(data => {
                    Papa.parse(data, {
                        header: true,
                        skipEmptyLines: true,
                        complete: function(results) {
                            szallitoiCimjegyzek = results.data;
                            const tbody = document.getElementById('szallitoi-cimjegyzek-tbody');
                            szallitoiCimjegyzek.forEach(row => {
                                const tr = document.createElement('tr');
                                tr.innerHTML = `
                                    <td>${row['Szállító neve'] || '-'}</td>
                                    <td>${row['Email'] || '-'}</td>
                                `;
                                tbody.appendChild(tr);
                            });
                        }
                    });
                })
                .catch(error => {
                    console.error('Hiba a szállítói címjegyzék betöltésekor:', error);
                    document.getElementById('szallitoi-cimjegyzek-error').textContent = 'Hiba: Nem sikerült betölteni a szállítói címjegyzéket. Kérlek, ellenőrizd a CSV fájlt és a szerver beállításokat.';
                });
        }

        function loadKeretrendelesek() {
            fetch('keretrendelesek.csv')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Nem sikerült betölteni a keretrendelesek.csv fájlt.');
                    }
                    return response.text();
                })
                .then(data => {
                    Papa.parse(data, {
                        header: true,
                        skipEmptyLines: true,
                        complete: function(results) {
                            keretrendelesek = results.data;
                            populateKeretrendelesekTable();
                            populateSzallitoSelect();
                            populateTeruletSelect();
                        }
                    });
                })
                .catch(error => {
                    console.error('Hiba a keretrendelések betöltésekor:', error);
                    document.getElementById('keretrendelesek-error').textContent = 'Hiba: Nem sikerült betölteni a keretrendeléseket. Ideiglenes adatok használata.';
                    keretrendelesek = fallbackKeretrendelesek;
                    populateKeretrendelesekTable();
                    populateSzallitoSelect();
                    populateTeruletSelect();
                });
        }

        function populateKeretrendelesekTable() {
            const tbody = document.getElementById('keretrendelesek-tbody');
            tbody.innerHTML = ''; // Töröljük a korábbi tartalmat
            keretrendelesek.forEach(row => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${row.Terület || '-'}</td>
                    <td>${row.Szállító || '-'}</td>
                    <td>${row.BMIg || '-'}</td>
                    <td>${row.PO || '-'}</td>
                    <td>${row['Érvényesség kezdete'] || '-'}</td>
                    <td>${row['Érvényesség vége'] || '-'}</td>
                    <td>${row.Megjegyzés || '-'}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        function populateSzallitoSelect() {
            const szallitoSelect = document.getElementById('new-szallito-select');
            const editSzallitoSelect = document.getElementById('edit-szallito-select');
            const szallitok = [...new Set(keretrendelesek.map(row => row.Szállító))].filter(szallito => szallito);

            szallitoSelect.innerHTML = '<option value="">Válassz szállítót</option>';
            editSzallitoSelect.innerHTML = '<option value="">Válassz szállítót</option>';

            szallitok.forEach(szallito => {
                const option = document.createElement('option');
                option.value = szallito;
                option.textContent = szallito;
                szallitoSelect.appendChild(option);
                editSzallitoSelect.appendChild(option.cloneNode(true));
            });
        }

        function populateTeruletSelect() {
            const teruletSelect = document.getElementById('new-terulet');
            const editTeruletSelect = document.getElementById('edit-terulet');
            const teruletek = [...new Set(keretrendelesek.map(row => row.Terület))].filter(terulet => terulet);

            teruletSelect.innerHTML = '<option value="">Válassz területet</option>';
            editTeruletSelect.innerHTML = '<option value="">Válassz területet</option>';

            teruletek.forEach(terulet => {
                const option = document.createElement('option');
                option.value = terulet;
                option.textContent = terulet;
                teruletSelect.appendChild(option);
                editTeruletSelect.appendChild(option.cloneNode(true));
            });
        }

        function openTab(tabId) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.querySelector(`.tab[onclick="openTab('${tabId}')"]`).classList.add('active');
            document.getElementById(tabId).classList.add('active');
        }

        function toggleFullscreen() {
            const container = document.getElementById('container');
            const fullscreenIcon = document.querySelector('.fullscreen-icon');
            if (!document.fullscreenElement) {
                container.requestFullscreen().catch(err => {
                    console.error(`Hiba a teljes képernyős mód bekapcsolásakor: ${err.message}`);
                });
                fullscreenIcon.classList.remove('fa-expand');
                fullscreenIcon.classList.add('fa-compress');
            } else {
                document.exitFullscreen();
                fullscreenIcon.classList.remove('fa-compress');
                fullscreenIcon.classList.add('fa-expand');
            }
        }

       function openNewRecordModal() { document.getElementById('newRecordModal').style.display = 'flex';
            updateFolyamatField();
            updatePriceFields();
            updateSzallitoField();
        }

        function closeNewRecordModal() {
            document.getElementById('newRecordModal').style.display = 'none';
            document.getElementById('newRecordForm').reset();
            document.getElementById('kontirozasi-nev-container').style.display = 'none';
            document.getElementById('szallito-select-container').style.display = 'none';
            document.getElementById('new-szallito').style.display = 'block';
            document.getElementById('new-szallito').labels[0].style.display = 'block';
        }

        function updateKontirozasField() {
            const rendelesTipus = document.getElementById('rendeles-tipus').value;
            const kontirozasContainer = document.getElementById('kontirozas-container');
            const kontirozasiNevContainer = document.getElementById('kontirozasi-nev-container');

            if (rendelesTipus === '3' || rendelesTipus === '4') {
                kontirozasContainer.style.display = 'block';
                if (rendelesTipus === '4') {
                    kontirozasiNevContainer.style.display = 'block';
                } else {
                    kontirozasiNevContainer.style.display = 'none';
                }
            } else {
                kontirozasContainer.style.display = 'none';
                kontirozasiNevContainer.style.display = 'none';
            }
        }

        function updateEditKontirozasField() {
            const rendelesTipus = document.getElementById('edit-rendeles-tipus').value;
            const kontirozasContainer = document.getElementById('edit-kontirozas-container');
            const kontirozasiNevContainer = document.getElementById('edit-kontirozasi-nev-container');

            if (rendelesTipus === '3' || rendelesTipus === '4') {
                kontirozasContainer.style.display = 'block';
                if (rendelesTipus === '4') {
                    kontirozasiNevContainer.style.display = 'block';
                } else {
                    kontirozasiNevContainer.style.display = 'none';
                }
            } else {
                kontirozasContainer.style.display = 'none';
                kontirozasiNevContainer.style.display = 'none';
            }
        }

        function updateFolyamatField() {
            const rendelesTipus = document.getElementById('rendeles-tipus').value;
            const folyamatSelect = document.getElementById('new-folyamat');
            folyamatSelect.innerHTML = '';

            const options = ['Beszerzés', 'Gyártás'];
            if (rendelesTipus === '3' || rendelesTipus === '4') {
                options.push('Javítás');
            }
            options.push('Szolgáltatás');

            options.forEach(option => {
                const opt = document.createElement('option');
                opt.value = option;
                opt.textContent = option;
                folyamatSelect.appendChild(opt);
            });
        }

        function updateEditFolyamatField() {
            const rendelesTipus = document.getElementById('edit-rendeles-tipus').value;
            const folyamatSelect = document.getElementById('edit-folyamat');
            folyamatSelect.innerHTML = '';

            const options = ['Beszerzés', 'Gyártás'];
            if (rendelesTipus === '3' || rendelesTipus === '4') {
                options.push('Javítás');
            }
            options.push('Szolgáltatás');

            options.forEach(option => {
                const opt = document.createElement('option');
                opt.value = option;
                opt.textContent = option;
                folyamatSelect.appendChild(opt);
            });
        }

        function updatePriceFields() {
            const rendelesTipus = document.getElementById('rendeles-tipus').value;
            const priceContainer = document.getElementById('price-container');
            if (rendelesTipus === '1') {
                priceContainer.style.display = 'none';
            } else {
                priceContainer.style.display = 'block';
            }
        }

        function updateEditPriceFields() {
            const rendelesTipus = document.getElementById('edit-rendeles-tipus').value;
            const priceContainer = document.getElementById('edit-price-container');
            if (rendelesTipus === '1') {
                priceContainer.style.display = 'none';
            } else {
                priceContainer.style.display = 'block';
            }
        }

        function updateSzallitoField() {
            const rendelesTipus = document.getElementById('rendeles-tipus').value;
            const szallitoInput = document.getElementById('new-szallito');
            const szallitoLabel = szallitoInput.labels[0];
            const szallitoSelectContainer = document.getElementById('szallito-select-container');
            const kontirozasiNevContainer = document.getElementById('kontirozasi-nev-container');

            if (rendelesTipus === '1') {
                szallitoInput.style.display = 'none';
                szallitoLabel.style.display = 'none';
                szallitoSelectContainer.style.display = 'block';
                kontirozasiNevContainer.style.display = 'block';
            } else {
                szallitoInput.style.display = 'block';
                szallitoLabel.style.display = 'block';
                szallitoSelectContainer.style.display = 'none';
                if (rendelesTipus !== '4') {
                    kontirozasiNevContainer.style.display = 'none';
                }
            }
        }

        function updateEditSzallitoField() {
            const rendelesTipus = document.getElementById('edit-rendeles-tipus').value;
            const szallitoInput = document.getElementById('edit-szallito');
            const szallitoLabel = szallitoInput.labels[0];
            const szallitoSelectContainer = document.getElementById('edit-szallito-select-container');
            const kontirozasiNevContainer = document.getElementById('edit-kontirozasi-nev-container');

            if (rendelesTipus === '1') {
                szallitoInput.style.display = 'none';
                szallitoLabel.style.display = 'none';
                szallitoSelectContainer.style.display = 'block';
                kontirozasiNevContainer.style.display = 'block';
            } else {
                szallitoInput.style.display = 'block';
                szallitoLabel.style.display = 'block';
                szallitoSelectContainer.style.display = 'none';
                if (rendelesTipus !== '4') {
                    kontirozasiNevContainer.style.display = 'none';
                }
            }
        }

        function updateKeretrendelesFields() {
            const rendelesTipus = document.getElementById('rendeles-tipus').value;
            if (rendelesTipus !== '1') return;

            const szallito = document.getElementById('new-szallito-select').value;
            const terulet = document.getElementById('new-terulet').value;

            if (szallito && terulet && keretrendelesek.length > 0) {
                const match = keretrendelesek.find(row => row.Szállító === szallito && row.Terület === terulet);
                if (match) {
                    document.getElementById('new-bmig').value = match.BMIg || '-';
                    document.getElementById('new-po').value = match.PO || '-';
                } else {
                    document.getElementById('new-bmig').value = '';
                    document.getElementById('new-po').value = '';
                }
            } else {
                document.getElementById('new-bmig').value = '';
                document.getElementById('new-po').value = '';
            }
        }

        function updateEditKeretrendelesFields() {
            const rendelesTipus = document.getElementById('edit-rendeles-tipus').value;
            if (rendelesTipus !== '1') return;

            const szallito = document.getElementById('edit-szallito-select').value;
            const terulet = document.getElementById('edit-terulet').value;

            if (szallito && terulet && keretrendelesek.length > 0) {
                const match = keretrendelesek.find(row => row.Szállító === szallito && row.Terület === terulet);
                if (match) {
                    document.getElementById('edit-bmig').value = match.BMIg || '-';
                    document.getElementById('edit-po').value = match.PO || '-';
                } else {
                    document.getElementById('edit-bmig').value = '';
                    document.getElementById('edit-po').value = '';
                }
            } else {
                document.getElementById('edit-bmig').value = '';
                document.getElementById('edit-po').value = '';
            }
        }

        function saveNewRecord() {
            const felveve = document.getElementById('new-felveve').value;
            const raktar = document.getElementById('new-raktar').value;
            const rendelesTipus = document.getElementById('rendeles-tipus').value;
            const kontirozas = rendelesTipus === '3' || rendelesTipus === '4' ? document.getElementById('new-kontirozas').value : '-';
            const terulet = rendelesTipus === '4' || rendelesTipus === '1' ? document.getElementById('new-terulet').value : '-';
            const kontirozasiNev = rendelesTipus === '4' || rendelesTipus === '1' ? terulet : '-';
            const megnevezes = document.getElementById('new-megnevezes').value;
            const folyamat = document.getElementById('new-folyamat').value;
            const szallito = rendelesTipus === '1' ? document.getElementById('new-szallito-select').value : document.getElementById('new-szallito').value;
            const szam = document.getElementById('new-szam').value;
            const ajanlatszam = document.getElementById('new-ajanlatszam').value;
            const mennyiseg = document.getElementById('new-mennyiseg').value;
            const egység = document.getElementById('new-egység').value;
            const ar = rendelesTipus === '1' ? '-' : document.getElementById('new-ar').value || '-';
            const eurHuf = rendelesTipus === '1' ? '-' : document.getElementById('new-eur-huf').value || '-';
            const bmig = document.getElementById('new-bmig').value || '-';
            const po = document.getElementById('new-po').value || '-';
            const tervezett = document.getElementById('new-tervezett').value || '-';

            if (!felveve || !raktar || !megnevezes || !folyamat || !szallito || !szam || !ajanlatszam || !mennyiseg || !egység) {
                alert('Kérlek, töltsd ki az összes kötelező mezőt!');
                return;
            }

            sorszamCounter++;
            const sorszam = `FR25#${String(sorszamCounter).padStart(4, '0')}`;

            const table = document.getElementById('logisztikai-table').getElementsByTagName('tbody')[0];
            const newRow = table.insertRow();
            newRow.setAttribute('data-ajanlatkikuldve', 'false');
            newRow.innerHTML = `
                <td><input type="checkbox" class="select-row"></td>
                <td><button class="edit-btn" onclick="openEditModal(this)">Szerkesztés</button></td>
                <td>${sorszam}</td>
                <td>${felveve}</td>
                <td>${raktar}</td>
                <td>${kontirozas}</td>
                <td>${kontirozasiNev}</td>
                <td><i class="fas fa-envelope not-sent" title="Levél küldése" onclick="sendEmailFromTable(this)"></i></td>
                <td>${megnevezes}</td>
                <td>${folyamat}</td>
                <td>${szallito}</td>
                <td>${szam}</td>
                <td>${ajanlatszam}</td>
                <td>${mennyiseg}</td>
                <td>${egység}</td>
                <td>${ar}</td>
                <td>${eurHuf}</td>
                <td>${bmig}</td>
                <td>${po}</td>
                <td>${tervezett}</td>
            `;

            closeNewRecordModal();
        }

        let currentRow;

        function openEditModal(button) {
            currentRow = button.parentElement.parentElement;
            document.getElementById('edit-felveve').value = currentRow.cells[3].textContent;
            document.getElementById('edit-raktar').value = currentRow.cells[4].textContent;
            document.getElementById('edit-megnevezes').value = currentRow.cells[8].textContent;
            document.getElementById('edit-folyamat').value = currentRow.cells[9].textContent;
            document.getElementById('edit-szallito').value = currentRow.cells[10].textContent;
            document.getElementById('edit-szallito-select').value = currentRow.cells[10].textContent;
            document.getElementById('edit-szam').value = currentRow.cells[11].textContent;
            document.getElementById('edit-ajanlatszam').value = currentRow.cells[12].textContent;
            document.getElementById('edit-mennyiseg').value = currentRow.cells[13].textContent;
            document.getElementById('edit-egység').value = currentRow.cells[14].textContent;
            document.getElementById('edit-ar').value = currentRow.cells[15].textContent === '-' ? '' : currentRow.cells[15].textContent;
            document.getElementById('edit-eur-huf').value = currentRow.cells[16].textContent === '-' ? 'EUR' : currentRow.cells[16].textContent;
            document.getElementById('edit-bmig').value = currentRow.cells[17].textContent === '-' ? '' : currentRow.cells[17].textContent;
            document.getElementById('edit-po').value = currentRow.cells[18].textContent === '-' ? '' : currentRow.cells[18].textContent;
            document.getElementById('edit-tervezett').value = currentRow.cells[19].textContent === '-' ? '' : currentRow.cells[19].textContent;

            const kontirozas = currentRow.cells[5].textContent;
            if (kontirozas !== '-') {
                document.getElementById('edit-kontirozas').value = kontirozas;
                document.getElementById('edit-rendeles-tipus').value = currentRow.cells[6].textContent === '-' ? '3' : '4';
            } else {
                document.getElementById('edit-rendeles-tipus').value = '2';
            }

            const kontirozasiNev = currentRow.cells[6].textContent;
            if (kontirozasiNev !== '-') {
                document.getElementById('edit-terulet').value = kontirozasiNev;
                document.getElementById('edit-rendeles-tipus').value = '4';
            }

            if (currentRow.cells[15].textContent === '-' && currentRow.cells[16].textContent === '-') {
                document.getElementById('edit-rendeles-tipus').value = '1';
            }

            updateEditKontirozasField();
            updateEditFolyamatField();
            updateEditPriceFields();
            updateEditSzallitoField();
            document.getElementById('editModal').style.display = 'flex';
        }

        function closeEditModal() {
            document.getElementById('editModal').style.display = 'none';
            document.getElementById('editForm').reset();
            document.getElementById('edit-kontirozasi-nev-container').style.display = 'none';
            document.getElementById('edit-szallito-select-container').style.display = 'none';
            document.getElementById('edit-szallito').style.display = 'block';
            document.getElementById('edit-szallito').labels[0].style.display = 'block';
            document.getElementById('email-result').textContent = '';
        }

        function saveEdit() {
            const felveve = document.getElementById('edit-felveve').value;
            const raktar = document.getElementById('edit-raktar').value;
            const rendelesTipus = document.getElementById('edit-rendeles-tipus').value;
            const kontirozas = rendelesTipus === '3' || rendelesTipus === '4' ? document.getElementById('edit-kontirozas').value : '-';
            const terulet = rendelesTipus === '4' || rendelesTipus === '1' ? document.getElementById('edit-terulet').value : '-';
            const kontirozasiNem = rendelesTipus === '4' || rendelesTipus === '1' ? terulet : '-';
            const megnevezes = document.getElementById('edit-megnevezes').value;
            const folyamat = document.getElementById('edit-folyamat').value;
            const szallito = rendelesTipus === '1' ? document.getElementById('edit-szallito-select').value : document.getElementById('edit-szallito').value;
            const szam = document.getElementById('edit-szam').value;
            const ajanlatszam = document.getElementById('edit-ajanlatszam').value;
            const mennyiseg = document.getElementById('edit-mennyiseg').value;
            const egység = document.getElementById('edit-egység').value;
            const ar = rendelesTipus === '1' ? '-' : document.getElementById('edit-ar').value || '-';
            const eurHuf = rendelesTipus === '1' ? '-' : document.getElementById('edit-eur-huf').value || '-';
            const bmig = document.getElementById('edit-bmig').value || '-';
            const po = document.getElementById('edit-po').value || '-';
            const tervezett = document.getElementById('edit-tervezett').value || '-';

            if (!felveve || !raktar || !megnevezes || !folyamat || !szallito || !szam || !ajanlatszam || !mennyiseg || !egység) {
                alert('Kérlek, töltsd ki az összes kötelező mezőt!');
                return;
            }

            currentRow.cells[3].textContent = felveve;
            currentRow.cells[4].textContent = raktar;
            currentRow.cells[5].textContent = kontirozas;
            currentRow.cells[6].textContent = kontirozasiNem;
            currentRow.cells[8].textContent = megnevezes;
            currentRow.cells[9].textContent = folyamat;
            currentRow.cells[10].textContent = szallito;
            currentRow.cells[11].textContent = szam;
            currentRow.cells[12].textContent = ajanlatszam;
            currentRow.cells[13].textContent = mennyiseg;
            currentRow.cells[14].textContent = egység;
            currentRow.cells[15].textContent = ar;
            currentRow.cells[16].textContent = eurHuf;
            currentRow.cells[17].textContent = bmig;
            currentRow.cells[18].textContent = po;
            currentRow.cells[19].textContent = tervezett;

            closeEditModal();
        }

        function sendEmail() {
            const szallito = document.getElementById('edit-szallito').value;
            const emailResult = document.getElementById('email-result');
            emailResult.textContent = `Levél elküldve a következő szállítónak: ${szallito}`;
            currentRow.setAttribute('data-ajanlatkikuldve', 'true');
            const envelopeIcon = currentRow.cells[7].querySelector('.fa-envelope');
            envelopeIcon.classList.remove('not-sent');
            envelopeIcon.classList.add('sent');
        }

        function sendEmailFromTable(icon) {
            const row = icon.parentElement.parentElement;
            const szallito = row.cells[10].textContent;
            alert(`Levél elküldve a következő szállítónak: ${szallito}`);
            row.setAttribute('data-ajanlatkikuldve', 'true');
            icon.classList.remove('not-sent');
            icon.classList.add('sent');
        }

        document.getElementById('select-all').addEventListener('change', function() {
            const checkboxes = document.querySelectorAll('.select-row');
            checkboxes.forEach(checkbox => {
                checkbox.checked = this.checked;
            });
        });
    </script>
</body>
</html>
